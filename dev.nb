(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     63348,       1606]
NotebookOptionsPosition[     62771,       1588]
NotebookOutlinePosition[     63164,       1604]
CellTagsIndexPosition[     63121,       1601]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"extractIndices", "[", "term_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"factors", ",", "mFactors", ",", "subs"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"factors", "=", 
        RowBox[{"List", "@@", "term"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"mFactors", "=", 
        RowBox[{"Select", "[", 
         RowBox[{"factors", ",", 
          RowBox[{
           RowBox[{"!", 
            RowBox[{"FreeQ", "[", 
             RowBox[{"#", ",", 
              RowBox[{"Subscript", "[", 
               RowBox[{"M", ",", "_"}], "]"}]}], "]"}]}], "&"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"subs", "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"Replace", "[", 
          RowBox[{"mFactors", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"_", ",", "sub_"}], "]"}], ":>", 
              RowBox[{"{", "sub", "}"}]}], ",", 
             RowBox[{
              RowBox[{"Power", "[", 
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"_", ",", "sub_"}], "]"}], ",", "pow_"}], "]"}], ":>", 
              RowBox[{"Table", "[", 
               RowBox[{"sub", ",", 
                RowBox[{"{", "pow", "}"}]}], "]"}]}]}], "}"}], ",", 
           RowBox[{"{", "1", "}"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Sort", "[", "subs", "]"}]}]}], "\[IndentingNewLine]", "]"}]}],
    ";"}], "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"augmentList", "[", "listOfLists_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"reversed", ",", "augmented"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"reversed", "=", 
        RowBox[{"Reverse", "/@", "listOfLists"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"augmented", "=", 
        RowBox[{"Join", "[", 
         RowBox[{"listOfLists", ",", "reversed"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DeleteDuplicates", "[", "augmented", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"extractAllIndices", "[", "expr_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "rawIndices", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"rawIndices", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Map", "[", 
          RowBox[{"extractIndices", ",", 
           RowBox[{"List", "@@", 
            RowBox[{"Expand", "[", "expr", "]"}]}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Reverse", "[", 
        RowBox[{"Sort", "[", " ", 
         RowBox[{"augmentList", "[", "rawIndices", "]"}], "]"}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"getLoopSchema", "[", "action_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "vars", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"vars", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"action", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{"M", ",", "_"}], "]"}], ",", "Infinity"}], "]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"derivatives", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Expand", "@", 
           RowBox[{"Simplify", "@", 
            RowBox[{"D", "[", 
             RowBox[{"action", ",", "#"}], "]"}]}]}], "&"}], "/@", "vars"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"Reverse", "@", 
        RowBox[{"Sort", "[", 
         RowBox[{"DeleteDuplicates", "[", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Map", "[", 
             RowBox[{"extractAllIndices", ",", "derivatives"}], "]"}], ",", 
            "1"}], "]"}], "]"}], "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"matrixProductFromIndexList", "[", "list_", "]"}], ":=", 
    RowBox[{"Times", "@@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Subscript", "[", 
         RowBox[{"M", ",", "#"}], "]"}], "&"}], "/@", "list"}], ")"}]}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"extractCoefficients", "[", 
     RowBox[{"S_", ",", "matrixIndex_", ",", "schema_"}], "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"schema", "==", 
       RowBox[{"Reverse", "[", "schema", "]"}]}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Coefficient", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"S", ",", 
          SubscriptBox["M", "matrixIndex"]}], "]"}], ",", 
        RowBox[{"matrixProductFromIndexList", "[", "schema", "]"}]}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       FractionBox["1", "2"], 
       RowBox[{"Coefficient", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"S", ",", 
           SubscriptBox["M", "matrixIndex"]}], "]"}], ",", 
         RowBox[{"matrixProductFromIndexList", "[", "schema", "]"}]}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createAllResolventWords", "[", "length_", "]"}], ":=", 
    RowBox[{"If", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"length", "==", "1"}], ",", 
      RowBox[{"Tuples", "[", 
       RowBox[{
        RowBox[{"DeleteCases", "[", 
         RowBox[{"matrixIndexRange", ",", "0"}], "]"}], ",", "1"}], "]"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"length", "==", "2"}], ",", 
        RowBox[{"Tuples", "[", 
         RowBox[{
          RowBox[{"DeleteCases", "[", 
           RowBox[{"matrixIndexRange", ",", "0"}], "]"}], ",", "2"}], "]"}], 
        ",", "\[IndentingNewLine]", 
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"Prepend", "[", 
             RowBox[{
              RowBox[{"Append", "[", 
               RowBox[{"inner", ",", "last"}], "]"}], ",", "first"}], "]"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"first", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"matrixIndexRange", ",", "0"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"last", ",", 
              RowBox[{"DeleteCases", "[", 
               RowBox[{"matrixIndexRange", ",", "0"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"inner", ",", 
              RowBox[{"Tuples", "[", 
               RowBox[{"matrixIndexRange", ",", 
                RowBox[{"length", "-", "2"}]}], "]"}]}], "}"}]}], "]"}], ",", 
          "2"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkIfResolventWordRedundant", "[", 
     RowBox[{"word_", ",", "positionInList_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"length", ",", " ", "remainingWordsList"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", "word", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"remainingWordsList", "=", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"Reverse", "[", 
           RowBox[{"createAllResolventWords", "[", "length", "]"}], "]"}], 
          ",", 
          RowBox[{
           RowBox[{"positionInList", "+", "1"}], ";;"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"MemberQ", "[", 
          RowBox[{"remainingWordsList", ",", 
           RowBox[{"Reverse", "[", "word", "]"}]}], "]"}], ",", "0", ",", 
         "word"}], "]"}]}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createUniqueResolventWords", "[", "level_", "]"}], ":=", 
    RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Table", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"checkIfResolventWordRedundant", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"Reverse", "[", 
            RowBox[{"createAllResolventWords", "[", "level", "]"}], "]"}], 
           "[", 
           RowBox[{"[", "i", "]"}], "]"}], ",", "i"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "[", 
           RowBox[{"createAllResolventWords", "[", "level", "]"}], "]"}]}], 
         "}"}]}], "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
      "0"}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createAllCorrelatorWords", "[", "level_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "iteratorList", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"iteratorList", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            SubscriptBox["i", "j"], ",", "matrixIndexRange"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "[", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox["i", "j"], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", " ", 
           RowBox[{
            RowBox[{"Sequence", "@@", "iteratorList"}], "//", "Evaluate"}]}], 
          "]"}], ",", 
         RowBox[{"level", "-", "1"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"checkIfCorrelatorWordRedundant", "[", 
     RowBox[{"word_", ",", "precedingWordPositionInList_"}], "]"}], ":=", 
    RowBox[{"Module", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "length", ",", "remainingWordsList", ",", " ", 
        "wordIncludingHermitianConjugateList"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", "word", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"remainingWordsList", "=", 
        RowBox[{"Part", "[", 
         RowBox[{
          RowBox[{"createAllCorrelatorWords", "[", "length", "]"}], ",", 
          RowBox[{";;", "precedingWordPositionInList"}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wordIncludingHermitianConjugateList", "=", 
        RowBox[{"{", 
         RowBox[{"word", ",", 
          RowBox[{"Reverse", "[", "word", "]"}]}], "}"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"wordIncludingHermitianConjugateList", "[", 
           RowBox[{"[", "k", "]"}], "]"}], "=", 
          RowBox[{"NestList", "[", 
           RowBox[{"RotateRight", ",", 
            RowBox[{"wordIncludingHermitianConjugateList", "[", 
             RowBox[{"[", "k", "]"}], "]"}], ",", 
            RowBox[{"length", "-", "1"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "1", ",", "2"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"IntersectingQ", "[", 
          RowBox[{"remainingWordsList", ",", 
           RowBox[{"Join", "@@", "wordIncludingHermitianConjugateList"}]}], 
          "]"}], ",", "0", ",", 
         RowBox[{"wordIncludingHermitianConjugateList", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createUniqueCorrelatorWords", "[", "level_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x", ",", "allCorrelatorWords", ",", "WordsByTraceSymmetry"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"allCorrelatorWords", "=", 
        RowBox[{"createAllCorrelatorWords", "[", "level", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
           "checkIfCorrelatorWordRedundant", "[", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"allCorrelatorWords", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"Length", "[", "allCorrelatorWords", "]"}], "+", "1", 
                "-", "i"}], "]"}], "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"Length", "[", "allCorrelatorWords", "]"}], "-", 
              "i"}]}], "\[IndentingNewLine]", "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"i", ",", "1", ",", 
             RowBox[{"Length", "[", "allCorrelatorWords", "]"}]}], "}"}]}], 
          "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", "0"}], 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createVariations", "[", "level_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "uniquePartitions", ",", "createTableIterator", ",", " ", 
        "createWordPartitions"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"level", "!=", "0"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"uniquePartitions", "=", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"i", "\[NotEqual]", "0"}], ",", 
              RowBox[{"Partition", "[", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
                RowBox[{"UpTo", "[", 
                 RowBox[{"level", "-", "i"}], "]"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"{", 
                   RowBox[{"k", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
                RowBox[{"{", "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{"Floor", "[", 
               FractionBox["level", "2"], "]"}]}], "}"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"createTableIterator", "[", "partition_", "]"}], ":=", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"Length", "[", 
              RowBox[{"partition", "[", 
               RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[NotEqual]", "0"}], 
            ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["i", "j"], ",", "matrixIndexRange"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", 
                  RowBox[{"Length", "[", 
                   RowBox[{"partition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"matrixIndexRange", ",", "0"}], "]"}]}], "}"}], 
               "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["j", 
                  RowBox[{"Length", "[", 
                   RowBox[{"partition", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"matrixIndexRange", ",", "0"}], "]"}]}], "}"}], 
               "}"}], ",", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["j", "i"], ",", "matrixIndexRange"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}]}], "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  SubscriptBox["i", "j"], ",", "matrixIndexRange"}], "}"}], 
                ",", 
                RowBox[{"{", 
                 RowBox[{"j", ",", "1", ",", 
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "-", "1"}]}], 
                 "}"}]}], "]"}], ",", 
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 SubscriptBox["i", 
                  RowBox[{"Length", "[", 
                   RowBox[{"partition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]], ",", 
                 RowBox[{"DeleteCases", "[", 
                  RowBox[{"matrixIndexRange", ",", "0"}], "]"}]}], "}"}], 
               "}"}]}], "]"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"createWordPartitions", "[", "partition_", "]"}], ":=", 
          RowBox[{"Flatten", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Table", "[", 
                 RowBox[{
                  SubscriptBox["i", "j"], ",", 
                  RowBox[{"{", 
                   RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"Length", "[", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}], "\[NotEqual]", 
                   "0"}], ",", 
                  RowBox[{"Table", "[", 
                   RowBox[{
                    SubscriptBox["j", "i"], ",", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{"partition", "[", 
                    RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}]}], "]"}], 
                  ",", 
                  RowBox[{"{", "}"}]}], "]"}]}], "}"}], ",", " ", 
              RowBox[{
               RowBox[{"Sequence", "@@", 
                RowBox[{"createTableIterator", "[", "partition", "]"}]}], "//",
                "Evaluate"}]}], "]"}], ",", 
            RowBox[{"level", "-", "1"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"Flatten", "[", 
          RowBox[{
           RowBox[{"Map", "[", 
            RowBox[{"createWordPartitions", ",", "uniquePartitions"}], "]"}], 
           ",", "1"}], "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "}"}], ",", 
          RowBox[{"{", "}"}]}], "}"}]}], "\[IndentingNewLine]", "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"InitializeLoopEquationsPackage", "[", 
     RowBox[{"action_", ",", "orientationMatrix_", ",", "maxLevel_"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "orientationInverse", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"originalMatrixVars", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"action", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{"Global`X", ",", "_"}], "]"}], ",", "Infinity"}], "]"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"originalMatrixIndexRange", "=", 
        RowBox[{"originalMatrixVars", "/.", " ", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"X", ",", "n_"}], "]"}], ":>", "n"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "originalMatrixVars", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"orientationInverse", "=", 
        RowBox[{"Simplify", "@", 
         RowBox[{"PowerExpand", "[", 
          RowBox[{"Inverse", "[", "orientationMatrix", "]"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"X", "=", 
        RowBox[{"(", 
         RowBox[{"orientationInverse", ".", 
          RowBox[{"Table", "[", 
           RowBox[{
            SubscriptBox["M", "i"], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "0", ",", 
              RowBox[{
               RowBox[{"Length", "[", "originalMatrixIndexRange", "]"}], "-", 
               "1"}]}], "}"}]}], "]"}]}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"S", "=", 
        RowBox[{"action", "/.", " ", 
         RowBox[{"Thread", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             SubscriptBox["X", "#"], "&"}], "/@", 
            "originalMatrixIndexRange"}], "->", "X"}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"matrixVars", "=", 
        RowBox[{"DeleteDuplicates", "[", 
         RowBox[{"Cases", "[", 
          RowBox[{"action", ",", 
           RowBox[{"Subscript", "[", 
            RowBox[{"M", ",", "_"}], "]"}], ",", "Infinity"}], "]"}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"matrixIndexRange", "=", 
        RowBox[{"matrixVars", "/.", " ", 
         RowBox[{
          RowBox[{"Subscript", "[", 
           RowBox[{"M", ",", "n_"}], "]"}], ":>", "n"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"loopSchema", "=", 
        RowBox[{"getLoopSchema", "[", "S", "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"actionCoefficients", "=", 
        RowBox[{"Simplify", "@", 
         RowBox[{"Table", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"extractCoefficients", "[", 
              RowBox[{"S", ",", "matrixIndex", ",", "schema"}], "]"}], "/.", 
             " ", 
             RowBox[{"Thread", "[", 
              RowBox[{"matrixVars", "->", "0"}], "]"}]}], ")"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"matrixIndex", ",", "matrixIndexRange"}], "}"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"schema", ",", "loopSchema"}], "}"}]}], 
          "\[IndentingNewLine]", "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"resolventWords", "[", "level", "]"}], "=", 
          RowBox[{"createUniqueResolventWords", "[", "level", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"level", ",", "1", ",", "maxLevel"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"correlatorWords", "[", "level", "]"}], "=", 
          RowBox[{"createUniqueCorrelatorWords", "[", "level", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"level", ",", "1", ",", "maxLevel"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"variations", "[", "level", "]"}], "=", 
          RowBox[{"createVariations", "[", "level", "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"level", ",", "0", ",", 
           RowBox[{"maxLevel", "-", "2"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["p", 
         RowBox[{"{", "}"}]], "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["p", "Null"], "=", "1"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Omega]", 
         RowBox[{"{", "}"}]], "=", "\[Omega]"}], ";", "\[IndentingNewLine]", 
       RowBox[{
        SubscriptBox["\[Omega]", "Null"], "=", "\[Omega]"}], ";"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"correlatorWordLookup", "[", "word_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"length", ",", "symmetricWordList", ",", "symmetricWord"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", "word", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"length", "!=", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"symmetricWordList", "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["symmetricWord", 
               RowBox[{"{", 
                RowBox[{"i", ",", "j"}], "}"}]], ",", 
              RowBox[{"{", 
               RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", "maxLevel"}], "}"}]}], "]"}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["symmetricWord", 
            RowBox[{"{", 
             RowBox[{"1", ",", "1"}], "}"}]], "=", "word"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "2"}], ",", 
            RowBox[{"i", "\[LessEqual]", "length"}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             SubscriptBox["symmetricWord", 
              RowBox[{"{", 
               RowBox[{"1", ",", "i"}], "}"}]], "=", 
             RowBox[{"RotateRight", "[", 
              SubscriptBox["symmetricWord", 
               RowBox[{"{", 
                RowBox[{"1", ",", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "}"}]], "]"}]}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["symmetricWord", 
            RowBox[{"{", 
             RowBox[{"2", ",", "1"}], "}"}]], "=", 
           RowBox[{"Reverse", "[", "word", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"For", "[", 
           RowBox[{
            RowBox[{"i", "=", "2"}], ",", 
            RowBox[{"i", "\[LessEqual]", "length"}], ",", 
            RowBox[{"i", "++"}], ",", 
            RowBox[{
             SubscriptBox["symmetricWord", 
              RowBox[{"{", 
               RowBox[{"2", ",", "i"}], "}"}]], "=", 
             RowBox[{"RotateRight", "[", 
              SubscriptBox["symmetricWord", 
               RowBox[{"{", 
                RowBox[{"2", ",", 
                 RowBox[{"(", 
                  RowBox[{"i", "-", "1"}], ")"}]}], "}"}]], "]"}]}]}], "]"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Which", "@@", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"MemberQ", "[", 
                  RowBox[{
                   RowBox[{"correlatorWords", "[", "length", "]"}], ",", 
                   SubscriptBox["symmetricWord", 
                    RowBox[{"{", 
                    RowBox[{"i", ",", "j"}], "}"}]]}], "]"}], ",", 
                 SubscriptBox["symmetricWord", 
                  RowBox[{"{", 
                   RowBox[{"i", ",", "j"}], "}"}]]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", "1", ",", "2"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"j", ",", "1", ",", "length"}], "}"}]}], "]"}], ",", 
             "2"}], "]"}]}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resolventWordLookup", "[", "word_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"length", ",", "symmetricWord"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"length", "=", 
        RowBox[{"Length", "[", "word", "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"length", "!=", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SubscriptBox["symmetricWord", "1"], "=", "word"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{
           SubscriptBox["symmetricWord", "2"], "=", 
           RowBox[{"Reverse", "[", "word", "]"}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"resolventWords", "[", "length", "]"}], ",", 
              SubscriptBox["symmetricWord", "1"]}], "]"}], ",", 
            SubscriptBox["symmetricWord", "1"], ",", 
            RowBox[{"MemberQ", "[", 
             RowBox[{
              RowBox[{"resolventWords", "[", "length", "]"}], ",", 
              SubscriptBox["symmetricWord", "2"]}], "]"}], ",", 
            SubscriptBox["symmetricWord", "2"]}], "]"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"{", "}"}]}], "\[IndentingNewLine]", "]"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"splitWordOnResolventLetter", "[", "word_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "x", ",", "rightmostResolventLetterPosition", ",", 
        "subwordsListAfterSplit"}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", "word", "]"}], "\[NotEqual]", "0"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "word", "]"}], "\[NotEqual]", 
            RowBox[{"Length", "[", 
             RowBox[{"Position", "[", 
              RowBox[{"word", ",", "0"}], "]"}], "]"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"rightmostResolventLetterPosition", "=", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Position", "[", 
                RowBox[{"word", ",", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                 "1", ",", "1"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}], "+", 
               RowBox[{"Position", "[", 
                RowBox[{
                 RowBox[{"Reverse", "[", "word", "]"}], ",", 
                 RowBox[{"_", "?", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                 "1", ",", "1"}], "]"}], "-", 
               RowBox[{"{", 
                RowBox[{"{", "1", "}"}], "}"}]}], ")"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"subwordsListAfterSplit", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{
                    RowBox[{"rightmostResolventLetterPosition", "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ",", 
               RowBox[{"Table", "[", 
                RowBox[{
                 RowBox[{"word", "[", 
                  RowBox[{"[", "j", "]"}], "]"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"j", ",", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{"word", ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                    "1", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"Length", "[", "word", "]"}], "-", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"Position", "[", 
                    RowBox[{
                    RowBox[{"Reverse", "[", "word", "]"}], ",", 
                    RowBox[{"_", "?", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"#", "\[NotEqual]", "0"}], "&"}], ")"}]}], ",", 
                    "1", ",", "1"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "+", "1"}]}], "}"}]}], 
                "]"}]}], "}"}]}], ";"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"subwordsListAfterSplit", "=", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"Table", "[", 
                RowBox[{"0", ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", "1", ",", 
                   RowBox[{"Length", "[", 
                    RowBox[{"Position", "[", 
                    RowBox[{"word", ",", "0"}], "]"}], "]"}]}], "}"}]}], 
                "]"}], ",", 
               RowBox[{"{", "}"}]}], "}"}]}], ";"}]}], "\[IndentingNewLine]", 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"subwordsListAfterSplit", "=", 
           RowBox[{"{", "}"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", "subwordsListAfterSplit"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"splitWordResolventWordLookup", "[", "word_", "]"}], ":=", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "word", "]"}], "\[NotEqual]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"splitWordOnResolventLetter", "[", "word", "]"}], "[", 
        RowBox[{"[", "1", "]"}], "]"}], ",", 
       RowBox[{"resolventWordLookup", "[", 
        RowBox[{
         RowBox[{"splitWordOnResolventLetter", "[", "word", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], "]"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "}"}], ",", 
       RowBox[{"{", "}"}]}], "}"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[CapitalDelta]", "[", 
     RowBox[{"word_", ",", "numberResolventLettersToAdd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"remainingWord", ",", "remainingCorrelatorWord", ",", "n"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"n", "=", "numberResolventLettersToAdd"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"remainingWord", "=", 
        RowBox[{
         RowBox[{"splitWordResolventWordLookup", "[", "word", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"remainingCorrelatorWord", "[", "lettersAdded_", "]"}], ":=", 
        
        RowBox[{"correlatorWordLookup", "[", 
         RowBox[{"Flatten", "[", 
          RowBox[{"Append", "[", 
           RowBox[{"remainingWord", ",", 
            RowBox[{"Table", "[", 
             RowBox[{"0", ",", 
              RowBox[{"{", 
               RowBox[{"j", ",", "1", ",", 
                RowBox[{"lettersAdded", "-", "1"}]}], "}"}]}], "]"}]}], "]"}],
           "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"n", "\[Equal]", "0"}], ",", "\[IndentingNewLine]", 
         SubscriptBox["\[Omega]", "remainingWord"], ",", 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           SuperscriptBox["z", "n"], 
           SubscriptBox["\[Omega]", "remainingWord"]}], "-", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             SuperscriptBox["z", 
              RowBox[{"n", "-", "m"}]], "  ", 
             SubscriptBox["p", 
              RowBox[{"remainingCorrelatorWord", "[", "m", "]"}]]}], ",", 
            RowBox[{"{", 
             RowBox[{"m", ",", "1", ",", "n"}], "}"}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
   ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createWordsGeneratedByActionVariation", "[", "wordList_", "]"}], 
    ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"Flatten", "[", 
       RowBox[{"Append", "[", 
        RowBox[{"#", ",", 
         RowBox[{"wordList", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{"Prepend", "[", 
          RowBox[{"#", ",", 
           RowBox[{"wordList", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], "&"}], "/@", 
       "loopSchema"}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resolventActionContribution", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coefficients", ",", "wordsGeneratedByActionVariation", ",", 
        "splitAndReducedWords", ",", " ", "resolventExpressions"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coefficients", "=", 
        RowBox[{"actionCoefficients", "[", 
         RowBox[{"[", 
          RowBox[{"matrixNumber", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wordsGeneratedByActionVariation", "=", 
        RowBox[{
        "createWordsGeneratedByActionVariation", "[", "wordList", "]"}]}], 
       ";", 
       RowBox[{"splitAndReducedWords", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
         "splitWordResolventWordLookup", ",", 
          "wordsGeneratedByActionVariation"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resolventExpressions", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", 
           RowBox[{
            RowBox[{"splitAndReducedWords", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{"splitAndReducedWords", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "loopSchema", "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"coefficients", ".", "resolventExpressions"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"splitWordListOnLetter", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"resolventLetterPositionList", ",", " ", "splitWordList"}], 
       "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"resolventLetterPositionList", "=", 
        RowBox[{"Position", "[", 
         RowBox[{"wordList", ",", "matrixNumber"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"splitWordList", "[", "splitPointList_", "]"}], ":=", 
        RowBox[{"If", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"splitPointList", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "1"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"wordList", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{";;", 
               RowBox[{
                RowBox[{"splitPointList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "]"}], "]"}], 
            ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{"wordList", "[", 
               RowBox[{"[", "2", "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"wordList", "[", 
                RowBox[{"[", "1", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"splitPointList", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], ";;"}], "]"}], 
               "]"}]}], "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"wordList", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{
                RowBox[{"splitPointList", "[", 
                 RowBox[{"[", "2", "]"}], "]"}], "+", "1"}], ";;"}], "]"}], 
             "]"}], ",", 
            RowBox[{"Join", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"wordList", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "[", 
               RowBox[{"[", 
                RowBox[{";;", 
                 RowBox[{
                  RowBox[{"splitPointList", "[", 
                   RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "]"}], "]"}],
               ",", 
              RowBox[{"wordList", "[", 
               RowBox[{"[", "1", "]"}], "]"}]}], "]"}]}], "}"}]}], "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"splitWordList", "/@", "resolventLetterPositionList"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"resolventJacobianContribution", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "splitWordList", ",", " ", "left", ",", " ", "right", ",", 
        "resolventContribution", ",", "wordContributionResolvents", ",", 
        "wordContributionCorrelatorWords", ",", "wordContribution"}], "}"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"left", "=", 
        RowBox[{"wordList", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"right", "=", 
        RowBox[{"wordList", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"splitWordList", "=", 
        RowBox[{"splitWordListOnLetter", "[", 
         RowBox[{"wordList", ",", "matrixNumber"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"resolventContribution", "=", 
        RowBox[{
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"left", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"splitWordResolventWordLookup", "[", "left", "]"}], "[", 
             
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], "*", 
         RowBox[{"\[CapitalDelta]", "[", 
          RowBox[{"right", ",", 
           RowBox[{"Length", "[", 
            RowBox[{
             RowBox[{"splitWordResolventWordLookup", "[", "right", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wordContributionResolvents", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"\[CapitalDelta]", "[", 
           RowBox[{
            RowBox[{"splitWordList", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", "2"}], "]"}], "]"}], ",", 
            RowBox[{"Length", "[", 
             RowBox[{
              RowBox[{"splitWordResolventWordLookup", "[", 
               RowBox[{"splitWordList", "[", 
                RowBox[{"[", 
                 RowBox[{"i", ",", "2"}], "]"}], "]"}], "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "splitWordList", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"wordContributionCorrelatorWords", "=", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"correlatorWordLookup", "[", 
           RowBox[{"splitWordList", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "1", ",", 
            RowBox[{"Length", "[", "splitWordList", "]"}]}], "}"}]}], "]"}]}],
        ";", "\[IndentingNewLine]", 
       RowBox[{"wordContribution", "=", 
        RowBox[{"wordContributionResolvents", ".", 
         RowBox[{"(", 
          RowBox[{"List", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"Subscript", "[", 
               RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
             "wordContributionCorrelatorWords"}], ")"}]}], ")"}]}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"matrixNumber", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"resolventContribution", "+", "wordContribution"}], ",", 
         "\[IndentingNewLine]", "wordContribution"}], "\[IndentingNewLine]", 
        "]"}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createResolventLoopEquation", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"resolventActionContribution", "[", 
      RowBox[{"wordList", ",", "matrixNumber"}], "]"}], "-", 
     RowBox[{"resolventJacobianContribution", "[", 
      RowBox[{"wordList", ",", "matrixNumber"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"correlatorActionContribution", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "coefficients", ",", "wordsGeneratedByActionVariation", ",", 
        "reducedWords", ",", "correlatorList"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"coefficients", "=", 
        RowBox[{"actionCoefficients", "[", 
         RowBox[{"[", 
          RowBox[{"matrixNumber", "+", "1"}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"wordsGeneratedByActionVariation", "=", 
        RowBox[{
        "createWordsGeneratedByActionVariation", "[", "wordList", "]"}]}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"reducedWords", "=", 
        RowBox[{"Map", "[", 
         RowBox[{
         "correlatorWordLookup", ",", "wordsGeneratedByActionVariation"}], 
         "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"correlatorList", "=", 
        RowBox[{"List", "@@", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"Subscript", "[", 
             RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", "reducedWords"}], 
          ")"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"coefficients", ".", "correlatorList"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"correlatorJacobianContribution", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "splitWordList", ",", "leftJacobianIndex", ",", "rightJacobianIndex"}],
        "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"splitWordList", "=", 
        RowBox[{"splitWordListOnLetter", "[", 
         RowBox[{"wordList", ",", " ", "matrixNumber"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"splitWordList", "!=", 
          RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"leftJacobianIndices", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"correlatorWordLookup", "[", 
              RowBox[{"splitWordList", "[", 
               RowBox[{"[", 
                RowBox[{"splitNumber", ",", "1"}], "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"splitNumber", ",", "1", ",", 
               RowBox[{"Length", "[", "splitWordList", "]"}]}], "}"}]}], 
            "]"}]}], ";", "\[IndentingNewLine]", 
          RowBox[{"rightJacobianIndices", "=", 
           RowBox[{"Table", "[", 
            RowBox[{
             RowBox[{"correlatorWordLookup", "[", 
              RowBox[{"Flatten", "[", 
               RowBox[{"Append", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"splitWordResolventWordLookup", "[", 
                   RowBox[{"splitWordList", "[", 
                    RowBox[{"[", 
                    RowBox[{"splitNumber", ",", "2"}], "]"}], "]"}], "]"}], 
                  "[", 
                  RowBox[{"[", "2", "]"}], "]"}], ",", 
                 RowBox[{"Table", "[", 
                  RowBox[{"0", ",", 
                   RowBox[{"{", 
                    RowBox[{"j", ",", "1", ",", 
                    RowBox[{"Length", "[", 
                    RowBox[{
                    RowBox[{"splitWordResolventWordLookup", "[", 
                    RowBox[{"splitWordList", "[", 
                    RowBox[{"[", 
                    RowBox[{"splitNumber", ",", "2"}], "]"}], "]"}], "]"}], 
                    "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}],
                 "]"}], "]"}], "]"}], ",", 
             RowBox[{"{", 
              RowBox[{"splitNumber", ",", "1", ",", "1"}], "}"}]}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
               "leftJacobianIndices"}], ")"}]}], ")"}], ".", 
           RowBox[{"(", 
            RowBox[{"List", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"Subscript", "[", 
                 RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", 
               "rightJacobianIndices"}], ")"}]}], ")"}]}]}], ",", 
         "\[IndentingNewLine]", "0"}], "\[IndentingNewLine]", "]"}]}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createCorrelatorLoopEquation", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"correlatorActionContribution", "[", 
      RowBox[{"wordList", ",", "matrixNumber"}], "]"}], "-", 
     RowBox[{"correlatorJacobianContribution", "[", 
      RowBox[{"wordList", ",", "matrixNumber"}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateAllResolventLoopEquations", "[", "level_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "variationList", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"level", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"variationList", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"variationList", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], "}"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"variations", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", "variationList", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"createResolventLoopEquation", "[", 
           RowBox[{"variation", ",", "matrixNumber"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"variation", ",", "variationList"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"matrixNumber", ",", "matrixIndexRange"}], "}"}]}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateIndividualResolventLoopEquation", "[", 
     RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"createResolventLoopEquation", "[", 
       RowBox[{"wordList", ",", "matrixNumber"}], "]"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"GenerateAllCorrelatorLoopEquations", "[", "level_", "]"}], ":=", 
    
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "variationList", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"level", "==", "0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"variationList", "=", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "}"}], ",", 
            RowBox[{"{", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"variationList", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", "}"}], ",", 
               RowBox[{"{", "}"}]}], "}"}], "}"}], ",", 
            RowBox[{"Flatten", "[", 
             RowBox[{
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"variations", "[", "i", "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", "level"}], "}"}]}], "]"}], ",", 
              "1"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Flatten", "@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"createCorrelatorLoopEquation", "[", 
           RowBox[{"variation", ",", "matrixNumber"}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"variation", ",", "variationList"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"matrixNumber", ",", "matrixIndexRange"}], "}"}]}], 
         "]"}]}]}]}], "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GenerateIndividualCorrelatorLoopEquation", "[", 
    RowBox[{"wordList_", ",", "matrixNumber_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"createCorrelatorLoopEquation", "[", 
      RowBox[{"wordList", ",", "matrixNumber"}], "]"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.90289531187479*^9, 3.9028953253146963`*^9}, {
   3.9028958118354263`*^9, 3.9028958124824266`*^9}, {3.902895944063136*^9, 
   3.9028959456322412`*^9}, {3.9028960154062357`*^9, 3.902896024535417*^9}, {
   3.902896565449943*^9, 3.902896567519978*^9}, {3.902896735548572*^9, 
   3.902896747684272*^9}, {3.90289692130588*^9, 3.902896924229282*^9}, {
   3.90289840188719*^9, 3.902898427028405*^9}, 3.902898459934608*^9, {
   3.902898505673005*^9, 3.902898530566147*^9}, {3.9028986401212673`*^9, 
   3.9028986981177177`*^9}, {3.90289873048271*^9, 3.902898868922065*^9}, {
   3.902898925456572*^9, 3.9028990004408417`*^9}, {3.9028990955197983`*^9, 
   3.902899152769102*^9}, {3.902899395954974*^9, 3.902899398720783*^9}, {
   3.902899859609926*^9, 3.902899870323853*^9}, {3.902899902581869*^9, 
   3.902899910188532*^9}, {3.902899944366275*^9, 3.9028999576632843`*^9}, {
   3.902900043633514*^9, 3.9029001000327787`*^9}, {3.9029001744497967`*^9, 
   3.902900176611187*^9}, {3.902900301700067*^9, 3.902900303902616*^9}, {
   3.902900345725498*^9, 3.902900572641736*^9}, {3.902900755616809*^9, 
   3.9029007609664583`*^9}, 3.902901428780662*^9, {3.902904526734583*^9, 
   3.902904530818112*^9}, {3.902908372414464*^9, 3.9029083880399027`*^9}, {
   3.9029085062786827`*^9, 3.902908558257207*^9}, 3.902913146562873*^9, 
   3.902915060958433*^9, {3.9029152429485598`*^9, 3.9029152558497143`*^9}, {
   3.902915288741283*^9, 3.9029152895861893`*^9}},
 CellLabel->
  "In[223]:=",ExpressionUUID->"461a781c-b681-4bbe-809d-f9a9baa3c10d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Potts3Action", "=", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["t", "2"], "-", "1"}], ")"}], "2"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["X", "0"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["X", "1"], "2"], "+", 
        SuperscriptBox[
         SubscriptBox["X", "2"], "2"]}], ")"}]}], "-", 
     RowBox[{
      SubscriptBox["X", "0"], 
      SubscriptBox["X", "1"]}], "-", 
     RowBox[{
      SubscriptBox["X", "1"], 
      SubscriptBox["X", "2"]}], "-", 
     RowBox[{
      SubscriptBox["X", "2"], 
      SubscriptBox["X", "0"]}], "+", 
     RowBox[{
      FractionBox[
       SubscriptBox["t", "3"], "3"], 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         SubscriptBox["X", "0"], "3"], "+", 
        SuperscriptBox[
         SubscriptBox["X", "1"], "3"], "+", 
        SuperscriptBox[
         SubscriptBox["X", "2"], "3"]}], ")"}]}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"orientationMatrix", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"maxLevel", "=", "6"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"InitializeLoopEquationsPackage", "[", 
  RowBox[{"Potts3Action", ",", "orientationMatrix", ",", "maxLevel"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.9028532306575203`*^9, 3.902853268296055*^9}, 
   3.9028536465389557`*^9, {3.902854016957752*^9, 3.902854025164526*^9}, {
   3.902896817588702*^9, 3.902896817654546*^9}, 3.902899230196301*^9, {
   3.902900124630103*^9, 3.902900130399727*^9}},
 CellLabel->
  "In[255]:=",ExpressionUUID->"eda4acbd-d2ca-4969-9e82-b7d4c35677bf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   SubscriptBox["X", "0"], ",", 
   SubscriptBox["X", "1"], ",", 
   SubscriptBox["X", "2"]}], "}"}]], "Print",
 CellChangeTimes->{3.9029007655830812`*^9, 3.902904172282148*^9, 
  3.9029044932171307`*^9, 3.902904533129416*^9, 3.902908411208809*^9, 
  3.902908525026009*^9, 3.902908568458149*^9, 3.9029118265463753`*^9, 
  3.902913155453308*^9, 3.902913613111191*^9, 3.902915065909045*^9, 
  3.902915262097207*^9, 3.902915293227462*^9},
 CellLabel->
  "During evaluation of \
In[255]:=",ExpressionUUID->"7f03f100-f987-4c1f-8b57-87464401b93c"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{4, Automatic}, {Automatic, 4}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"29904f88-d318-4ea4-83b1-ebd779545c1d"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 59607, 1486, 5498, "Input",ExpressionUUID->"461a781c-b681-4bbe-809d-f9a9baa3c10d"],
Cell[CellGroupData[{
Cell[60190, 1510, 1981, 60, 112, "Input",ExpressionUUID->"eda4acbd-d2ca-4969-9e82-b7d4c35677bf"],
Cell[62174, 1572, 581, 13, 24, "Print",ExpressionUUID->"7f03f100-f987-4c1f-8b57-87464401b93c"]
}, Open  ]]
}
]
*)

